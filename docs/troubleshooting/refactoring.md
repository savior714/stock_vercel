# 리팩토링 및 코드 품질 관련 트러블슈팅

### 리팩토링 중 `multi_replace_file_content` 매칭 오류

**증상:**
파일 수정 시 `target content not found` 에러가 발생하며 수동 수정이 필요해짐.

**원인:**
코드 내의 공백, 들여쓰기 또는 이전 수정 사항이 반영되지 않은 상태에서 큰 블록을 수정하려 할 때 발생.

**해결 방법:**
- 수정 범위를 더 작고 명확한 단위(`replace_file_content`)로 쪼개어 실행.
- 수정 전 `view_file`로 최신 상태를 반드시 재확인.

### 훅(Hook) 로직 파손 및 빌드 에러

**증상:**
`useAnalysis.ts` 등 복잡한 훅 리팩토링 후 대량의 TypeScript 에러 발생.

**원인:**
미사용 변수 제거 과정에서 상태 변수(`shouldStop`)와 참조 변수(`shouldStopRef`) 간의 관계를 오인하여 `setShouldStop` 호출부를 누락하거나 코드 구조가 깨짐.

**해결 방법:**
- 코드 구조를 즉시 복원하고 리팩토링 대상을 `Ref`와 `State` 간의 역할 분담에 맞춰 다시 정리.
- `tsc --noEmit`을 자주 실행하여 실시간으로 타입 무결성 확인.
